<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ¬ ìŠ¤í† ë¦¬ë³´ë“œ ë©”ì´ì»¤</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --blue-50: #eff6ff;
      --blue-100: #dbeafe;
      --blue-200: #bfdbfe;
      --blue-300: #93c5fd;
      --blue-500: #3b82f6;
      --blue-600: #2563eb;
      --blue-700: #1d4ed8;
      --green-50: #f0fdf4;
      --green-500: #22c55e;
      --green-600: #16a34a;
      --green-700: #15803d;
      --red-500: #ef4444;
      --red-600: #dc2626;
      --gray-50: #f9fafb;
      --gray-100: #f3f4f6;
      --gray-200: #e5e7eb;
      --gray-300: #d1d5db;
      --gray-400: #9ca3af;
      --gray-500: #6b7280;
      --gray-600: #4b5563;
      --gray-700: #374151;
      --gray-800: #1f2937;
      --gray-900: #111827;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      background-color: var(--gray-100);
      color: var(--gray-900);
      line-height: 1.5;
    }

    .min-h-screen {
      min-height: 100vh;
    }

    .bg-gray-100 {
      background-color: var(--gray-100);
    }

    .bg-white {
      background-color: white;
    }

    .bg-gray-50 {
      background-color: var(--gray-50);
    }

    .bg-blue-50 {
      background-color: var(--blue-50);
    }

    .bg-green-50 {
      background-color: var(--green-50);
    }

    .bg-blue-600 {
      background-color: var(--blue-600);
    }

    .bg-blue-500 {
      background-color: var(--blue-500);
    }

    .bg-red-500 {
      background-color: var(--red-500);
    }

    .bg-green-500 {
      background-color: var(--green-500);
    }

    .bg-green-600 {
      background-color: var(--green-600);
    }

    .bg-gray-300 {
      background-color: var(--gray-300);
    }

    .text-white {
      color: white;
    }

    .text-gray-900 {
      color: var(--gray-900);
    }

    .text-gray-700 {
      color: var(--gray-700);
    }

    .text-gray-600 {
      color: var(--gray-600);
    }

    .text-gray-500 {
      color: var(--gray-500);
    }

    .text-sm {
      font-size: 0.875rem;
    }

    .text-lg {
      font-size: 1.125rem;
    }

    .text-2xl {
      font-size: 1.5rem;
    }

    .text-3xl {
      font-size: 1.875rem;
    }

    .font-medium {
      font-weight: 500;
    }

    .font-semibold {
      font-weight: 600;
    }

    .font-bold {
      font-weight: 700;
    }

    .uppercase {
      text-transform: uppercase;
    }

    header {
      background-color: white;
      box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
      position: sticky;
      top: 0;
      z-index: 50;
    }

    .header-content {
      max-width: 80rem;
      margin: 0 auto;
      padding: 1rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    main {
      max-width: 80rem;
      margin: 0 auto;
      padding: 2rem 1rem;
    }

    .grid {
      display: grid;
      gap: 1rem;
    }

    .grid-cols-1 {
      grid-template-columns: repeat(1, minmax(0, 1fr));
    }

    .grid-cols-2 {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 1rem;
    }

    .grid-cols-3 {
      display: grid;
      grid-template-columns: repeat(3, minmax(0, 1fr));
      gap: 1rem;
    }

    @media (min-width: 768px) {
      .md\:grid-cols-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
    }

    @media (min-width: 1024px) {
      .lg\:grid-cols-3 {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .gap-2 {
      gap: 0.5rem;
    }

    .gap-3 {
      gap: 0.75rem;
    }

    .gap-4 {
      gap: 1rem;
    }

    .gap-6 {
      gap: 1.5rem;
    }

    .mb-2 {
      margin-bottom: 0.5rem;
    }

    .mb-3 {
      margin-bottom: 0.75rem;
    }

    .mb-4 {
      margin-bottom: 1rem;
    }

    .mb-6 {
      margin-bottom: 1.5rem;
    }

    .mb-8 {
      margin-bottom: 2rem;
    }

    .mt-1 {
      margin-top: 0.25rem;
    }

    .mt-2 {
      margin-top: 0.5rem;
    }

    .mt-4 {
      margin-bottom: 1rem;
    }

    .space-y-2 > * + * {
      margin-top: 0.5rem;
    }

    .space-y-4 > * + * {
      margin-top: 1rem;
    }

    .space-y-6 > * + * {
      margin-top: 1.5rem;
    }

    .py-2 {
      padding-top: 0.5rem;
      padding-bottom: 0.5rem;
    }

    .py-3 {
      padding-top: 0.75rem;
      padding-bottom: 0.75rem;
    }

    .py-4 {
      padding-top: 1rem;
      padding-bottom: 1rem;
    }

    .py-8 {
      padding-top: 2rem;
      padding-bottom: 2rem;
    }

    .py-12 {
      padding-top: 3rem;
      padding-bottom: 3rem;
    }

    .py-16 {
      padding-top: 4rem;
      padding-bottom: 4rem;
    }

    .px-2 {
      padding-left: 0.5rem;
      padding-right: 0.5rem;
    }

    .px-3 {
      padding-left: 0.75rem;
      padding-right: 0.75rem;
    }

    .px-4 {
      padding-left: 1rem;
      padding-right: 1rem;
    }

    .px-6 {
      padding-left: 1.5rem;
      padding-right: 1.5rem;
    }

    .px-8 {
      padding-left: 2rem;
      padding-right: 2rem;
    }

    .p-4 {
      padding: 1rem;
    }

    .p-6 {
      padding: 1.5rem;
    }

    .rounded {
      border-radius: 0.25rem;
    }

    .rounded-lg {
      border-radius: 0.5rem;
    }

    .rounded-xl {
      border-radius: 0.75rem;
    }

    .border {
      border: 1px solid var(--gray-300);
    }

    .border-2 {
      border: 2px solid;
    }

    .border-gray-300 {
      border-color: var(--gray-300);
    }

    .border-blue-200 {
      border-color: var(--blue-200);
    }

    .border-green-200 {
      border-color: #dcfce7;
    }

    .border-green-300 {
      border-color: #86efac;
    }

    .border-dashed {
      border-style: dashed;
    }

    .border-l-4 {
      border-left: 4px solid;
    }

    .border-blue-500 {
      border-color: var(--blue-500);
    }

    .w-full {
      width: 100%;
    }

    .flex {
      display: flex;
    }

    .flex-1 {
      flex: 1 1 0%;
    }

    .flex-col {
      flex-direction: column;
    }

    .items-center {
      align-items: center;
    }

    .items-start {
      align-items: flex-start;
    }

    .justify-between {
      justify-content: space-between;
    }

    .justify-center {
      display: flex;
      justify-content: center;
    }

    button {
      cursor: pointer;
      border: none;
      font-family: inherit;
      font-size: inherit;
    }

    button:hover {
      opacity: 0.9;
    }

    .btn {
      padding: 0.5rem 1rem;
      border-radius: 0.5rem;
      font-weight: 500;
      transition: background-color 0.2s;
      display: inline-block;
      text-align: center;
    }

    .btn-primary {
      background-color: var(--blue-600);
      color: white;
    }

    .btn-primary:hover {
      background-color: var(--blue-700);
    }

    .btn-success {
      background-color: var(--green-600);
      color: white;
    }

    .btn-success:hover {
      background-color: var(--green-700);
    }

    .btn-danger {
      background-color: var(--red-500);
      color: white;
    }

    .btn-danger:hover {
      background-color: var(--red-600);
    }

    .btn-secondary {
      background-color: var(--gray-300);
      color: var(--gray-700);
    }

    .btn-secondary:hover {
      background-color: var(--gray-400);
    }

    input, textarea, select {
      padding: 0.5rem 1rem;
      border: 1px solid var(--gray-300);
      border-radius: 0.5rem;
      font-family: inherit;
      font-size: inherit;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      ring: 2px solid var(--blue-500);
      box-shadow: 0 0 0 3px var(--blue-200);
    }

    .shadow-md {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    }

    .shadow-lg {
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
    }

    .shadow-xl {
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    }

    .hover\:shadow-lg:hover {
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }

    .transition {
      transition: all 0.2s;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
      z-index: 50;
      max-height: 100vh;
      overflow-y: auto;
    }

    .modal {
      background-color: white;
      border-radius: 0.5rem;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
      padding: 1.5rem;
      max-width: 36rem;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
    }

    .card {
      background-color: white;
      padding: 1.5rem;
      border-radius: 0.5rem;
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }

    .card:hover {
      box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    }

    .composition-badge {
      display: inline-block;
      padding: 0.25rem 0.75rem;
      border-radius: 0.25rem;
      font-size: 0.875rem;
      font-weight: 600;
      text-transform: uppercase;
    }

    .composition-high_angle {
      background-color: #fecaca;
      color: #7f1d1d;
    }

    .composition-eye_level {
      background-color: #bfdbfe;
      color: #1e3a8a;
    }

    .composition-low_angle {
      background-color: #86efac;
      color: #15803d;
    }

    .composition-dutch_angle {
      background-color: #fcd34d;
      color: #78350f;
    }

    .gradient-to-r {
      background: linear-gradient(to right, var(--blue-600), var(--blue-700));
    }

    .gradient-to-b {
      background: linear-gradient(to bottom, var(--gray-50), white);
    }

    .hidden {
      display: none;
    }

    label {
      display: block;
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--gray-700);
      margin-bottom: 0.5rem;
    }

    .form-group {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }

    textarea {
      resize: vertical;
      min-height: 4rem;
    }

    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }

    .info-badge {
      display: inline-block;
      padding: 0.25rem 0.5rem;
      background-color: var(--blue-50);
      color: var(--blue-600);
      border-radius: 0.25rem;
      font-size: 0.75rem;
      font-weight: 600;
    }

    .info-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .info-item {
      background-color: var(--gray-50);
      padding: 0.4rem 0.5rem;
      border-radius: 0.375rem;
      border-left: 2px solid var(--blue-500);
    }

    .info-label {
      font-size: 0.65rem;
      color: var(--gray-500);
      text-transform: uppercase;
      font-weight: 600;
      margin-bottom: 0.15rem;
    }

    .info-value {
      font-size: 0.8rem;
      color: var(--gray-900);
      font-weight: 500;
    }

    @media (max-width: 768px) {
      .md\:grid-cols-2 {
        grid-template-columns: repeat(1, minmax(0, 1fr));
      }

      .lg\:grid-cols-3 {
        grid-template-columns: repeat(1, minmax(0, 1fr));
      }

      header {
        flex-wrap: wrap;
      }

      .header-content {
        flex-direction: column;
        gap: 1rem;
      }
    }

    h1 {
      font-size: 1.875rem;
      font-weight: bold;
    }

    h2 {
      font-size: 1.5rem;
      font-weight: bold;
    }

    h3 {
      font-size: 1.25rem;
      font-weight: bold;
    }

    h4 {
      font-size: 1.125rem;
      font-weight: 600;
    }

    p {
      margin: 0;
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <script>
    // ============================================
    // íƒ€ì… ì •ì˜ ë° ìƒìˆ˜
    // ============================================

    const STORAGE_KEY = 'storyboards';

    const COMPOSITIONS = [
      { value: 'high_angle', label: 'í•˜ì´ì•µê¸€ (ìœ„ì—ì„œ ë‚´ë ¤ë‹¤ë³´ê¸°)' },
      { value: 'eye_level', label: 'ì•„ì´ë ˆë²¨ (ëˆˆë†’ì´)' },
      { value: 'low_angle', label: 'ë¡œìš°ì•µê¸€ (ì•„ë˜ì—ì„œ ì˜¬ë ¤ë‹¤ë³´ê¸°)' },
      { value: 'dutch_angle', label: 'ë”ì¹˜ì•µê¸€ (ê¸°ìš¸ì–´ì§„ ê°ë„)' },
    ];

    const SIZES = [
      { value: 'long_shot', label: 'LS - ë¡±ìƒ· (ì „ì²´ ë°°ê²½ í¬í•¨)' },
      { value: 'full_shot', label: 'FS - í’€ìƒ· (ì¸ë¬¼ ì „ì‹ )' },
      { value: 'knee_shot', label: 'KS - ë‹ˆìƒ· (ë¬´ë¦ ìœ„)' },
      { value: 'middle_shot', label: 'MS - ë¯¸ë“¤ìƒ· (í—ˆë¦¬ ìœ„)' },
      { value: 'bust_shot', label: 'BS - ë°”ìŠ¤íŠ¸ìƒ· (ê°€ìŠ´ ìœ„)' },
      { value: 'head_shoulder', label: 'HS - í—¤ë“œ ìˆ„ë” (ë¨¸ë¦¬&ì–´ê¹¨)' },
      { value: 'head_close_up', label: 'HCU - í—¤ë“œ í´ë¡œì¦ˆì—… (ì–¼êµ´ë§Œ)' },
      { value: 'object_close_up', label: 'OCU - ë¬¼ì²´ í´ë¡œì¦ˆì—…' },
    ];

    const LENSES = [
      { value: '24mm', label: '24mm (ê´‘ê°)' },
      { value: '35mm', label: '35mm' },
      { value: '50mm', label: '50mm (í‘œì¤€)' },
      { value: '85mm', label: '85mm (í¬íŠ¸ë ˆì´íŠ¸)' },
      { value: '105mm', label: '105mm' },
      { value: '200mm', label: '200mm (ë§ì›)' },
    ];

    const MOVINGS = [
      { value: 'static', label: 'ìŠ¤íƒœí‹± (ì›€ì§ì„ ì—†ìŒ)' },
      { value: 'pan', label: 'íŒ¬ (ì¢Œìš° ì›€ì§ì„)' },
      { value: 'tilt', label: 'í‹¸íŠ¸ (ìœ„ì•„ë˜ ì›€ì§ì„)' },
      { value: 'dolly_in', label: 'ëŒë¦¬ ì¸ (ì „ì§„ ì›€ì§ì„)' },
      { value: 'dolly_out', label: 'ëŒë¦¬ ì•„ì›ƒ (í›„ì§„ ì›€ì§ì„)' },
      { value: 'crane', label: 'í¬ë ˆì¸ (ë†’ë‚®ì´ ì›€ì§ì„)' },
      { value: 'zoom', label: 'ì¤Œ' },
      { value: 'tracking', label: 'íŠ¸ë˜í‚¹ (ë”°ë¼ê°)' },
      { value: 'handheld', label: 'í•¸ë“œí—¬ë“œ (ì† í”ë“¤ë¦¼)' },
    ];

    // ìƒˆ ìš”ì†Œë“¤ - 3, 4, 6, 7
    const TECHNIQUES = [
      { value: 'normal', label: 'ì¼ë°˜ì´¬ì˜' },
      { value: 'slow_motion', label: 'ìŠ¬ë¡œëª¨ì…˜' },
      { value: 'timelapse', label: 'íƒ€ì„ë©ìŠ¤' },
      { value: 'high_speed', label: 'í•˜ì´ìŠ¤í”¼ë“œ' },
    ];

    const RESOLUTIONS = [
      { value: '4k', label: '4K (3840x2160)' },
      { value: '2k', label: '2K (2560x1440)' },
      { value: '1080p', label: '1080p (Full HD)' },
      { value: '720p', label: '720p (HD)' },
    ];

    const FPS_OPTIONS = [
      { value: '24', label: '24fps' },
      { value: '25', label: '25fps' },
      { value: '30', label: '30fps' },
      { value: '60', label: '60fps' },
      { value: '120', label: '120fps' },
    ];

    const COLOR_SPACES = [
      { value: 'srgb', label: 'sRGB' },
      { value: 'dci-p3', label: 'DCI-P3' },
      { value: 'rec2020', label: 'Rec.2020' },
      { value: 'log', label: 'Log (C-Log, S-Log)' },
    ];

    // ì”¬ ì‹œê°„ëŒ€
    const TIME_OF_DAYS = [
      { value: 'day', label: 'â˜€ï¸ ë‚®' },
      { value: 'night', label: 'ğŸŒ™ ë°¤' },
      { value: 'dawn', label: 'ğŸŒ… ìƒˆë²½' },
      { value: 'dusk', label: 'ğŸŒ† í™©í˜¼' },
      { value: 'golden_hour', label: 'âœ¨ ê³¨ë“ ì•„ì›Œ' },
      { value: 'blue_hour', label: 'ğŸŒŒ ë¸”ë£¨ì•„ì›Œ' },
    ];

    // ============================================
    // ìŠ¤í† ë¦¬ë³´ë“œ ë§¤ë‹ˆì € í´ë˜ìŠ¤
    // ============================================

    class StoryboardManager {
      constructor(autoSave = true) {
        this.storyboards = new Map();
        this.autoSave = autoSave;
        this.loadFromStorage();
      }

      generateId() {
        return `${Date.now()}-${Math.random().toString(36).substr(2, 9)}`;
      }

      loadFromStorage() {
        const data = localStorage.getItem(STORAGE_KEY);
        if (!data) return;
        try {
          const storyboards = JSON.parse(data);
          storyboards.forEach(sb => {
            sb.createdAt = new Date(sb.createdAt);
            sb.updatedAt = new Date(sb.updatedAt);
            sb.scenes = (sb.scenes || []).map(scene => ({
              ...scene,
              createdAt: new Date(scene.createdAt),
              updatedAt: new Date(scene.updatedAt),
            }));
            this.storyboards.set(sb.id, sb);
          });
        } catch (error) {
          console.error('ìŠ¤í† ë¦¬ë³´ë“œ ë¡œë“œ ì‹¤íŒ¨:', error);
        }
      }

      persistToStorage() {
        if (this.autoSave) {
          const data = Array.from(this.storyboards.values());
          localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
        }
      }

      createStoryboard(title, description = '') {
        const storyboard = {
          id: this.generateId(),
          title,
          description,
          scenes: [],
          // ë§ˆìŠ¤í„° ì‚¬ì–‘
          masterResolution: '1080p',
          masterFps: '24',
          masterColorSpace: 'srgb',
          createdAt: new Date(),
          updatedAt: new Date(),
        };
        this.storyboards.set(storyboard.id, storyboard);
        this.persistToStorage();
        return storyboard;
      }

      getStoryboard(id) {
        const sb = this.storyboards.get(id);
        if (!sb) throw new Error('Storyboard not found');
        return sb;
      }

      getAllStoryboards() {
        return Array.from(this.storyboards.values());
      }

      deleteStoryboard(id) {
        this.storyboards.delete(id);
        this.persistToStorage();
      }

      addScene(storyboardId, name, description = '') {
        const storyboard = this.getStoryboard(storyboardId);
        const scene = {
          id: this.generateId(),
          sceneNumber: storyboard.scenes.length + 1,
          name,
          description,
          shots: [],
          // ì‹œê°„ëŒ€
          timeOfDay: 'day',
          createdAt: new Date(),
          updatedAt: new Date(),
        };
        storyboard.scenes.push(scene);
        this.updateStoryboardTimestamp(storyboardId);
        this.persistToStorage();
        return scene;
      }

      deleteScene(storyboardId, sceneId) {
        const storyboard = this.getStoryboard(storyboardId);
        const idx = storyboard.scenes.findIndex(s => s.id === sceneId);
        if (idx === -1) throw new Error('Scene not found');
        storyboard.scenes.splice(idx, 1);
        storyboard.scenes.forEach((scene, i) => {
          scene.sceneNumber = i + 1;
        });
        this.updateStoryboardTimestamp(storyboardId);
        this.persistToStorage();
      }

      addShot(storyboardId, sceneId, shotData) {
        const storyboard = this.getStoryboard(storyboardId);
        const scene = storyboard.scenes.find(s => s.id === sceneId);
        if (!scene) throw new Error('Scene not found');

        const shot = {
          id: this.generateId(),
          shotNumber: scene.shots.length + 1,
          composition: shotData.composition,
          size: shotData.size,
          lens: shotData.lens,
          moving: shotData.moving,
          description: shotData.description || '',
          notes: shotData.notes || '',
          // ìƒˆ í•„ë“œë“¤
          technique: shotData.technique || 'normal',
          duration: shotData.duration || '3',
          character: shotData.character || '',
          location: shotData.location || '',
          props: shotData.props || '',
          setDesign: shotData.setDesign || '',
        };
        scene.shots.push(shot);
        this.updateStoryboardTimestamp(storyboardId);
        this.persistToStorage();
        return shot;
      }

      deleteShot(storyboardId, sceneId, shotId) {
        const storyboard = this.getStoryboard(storyboardId);
        const scene = storyboard.scenes.find(s => s.id === sceneId);
        if (!scene) throw new Error('Scene not found');

        const idx = scene.shots.findIndex(s => s.id === shotId);
        if (idx === -1) throw new Error('Shot not found');
        scene.shots.splice(idx, 1);
        scene.shots.forEach((shot, i) => {
          shot.shotNumber = i + 1;
        });
        this.updateStoryboardTimestamp(storyboardId);
        this.persistToStorage();
      }

      updateShot(storyboardId, sceneId, shotId, updates) {
        const storyboard = this.getStoryboard(storyboardId);
        const scene = storyboard.scenes.find(s => s.id === sceneId);
        if (!scene) throw new Error('Scene not found');

        const shot = scene.shots.find(s => s.id === shotId);
        if (!shot) throw new Error('Shot not found');

        if (updates.composition !== undefined) shot.composition = updates.composition;
        if (updates.size !== undefined) shot.size = updates.size;
        if (updates.lens !== undefined) shot.lens = updates.lens;
        if (updates.moving !== undefined) shot.moving = updates.moving;
        if (updates.description !== undefined) shot.description = updates.description;
        if (updates.notes !== undefined) shot.notes = updates.notes;
        if (updates.technique !== undefined) shot.technique = updates.technique;
        if (updates.duration !== undefined) shot.duration = updates.duration;
        if (updates.character !== undefined) shot.character = updates.character;
        if (updates.location !== undefined) shot.location = updates.location;
        if (updates.props !== undefined) shot.props = updates.props;
        if (updates.setDesign !== undefined) shot.setDesign = updates.setDesign;

        this.updateStoryboardTimestamp(storyboardId);
        this.persistToStorage();
        return shot;
      }

      updateStoryboardTimestamp(storyboardId) {
        const sb = this.storyboards.get(storyboardId);
        if (sb) sb.updatedAt = new Date();
      }

      exportStoryboard(storyboard) {
        return JSON.stringify(storyboard, null, 2);
      }

      importStoryboard(jsonData) {
        try {
          const data = JSON.parse(jsonData);
          if (!data.id || !data.title || !Array.isArray(data.scenes)) {
            return null;
          }
          data.createdAt = new Date(data.createdAt);
          data.updatedAt = new Date(data.updatedAt);
          data.scenes = data.scenes.map(scene => ({
            ...scene,
            createdAt: new Date(scene.createdAt),
            updatedAt: new Date(scene.updatedAt),
          }));
          this.storyboards.set(data.id, data);
          this.persistToStorage();
          return data;
        } catch (error) {
          console.error('ìŠ¤í† ë¦¬ë³´ë“œ ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨:', error);
          return null;
        }
      }
    }

    // ============================================
    // ì „ì—­ ìƒíƒœ ë° ê´€ë¦¬
    // ============================================

    const manager = new StoryboardManager(true);
    let currentStoryboard = null;

    // ============================================
    // UI ë Œë”ë§ í•¨ìˆ˜
    // ============================================

    function createSelect(id, label, options, value, onChange) {
      return `
        <div>
          <label for="${id}" class="text-sm font-medium text-gray-700 mb-2">${label}</label>
          <select id="${id}" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
            ${options.map(opt => `<option value="${opt.value}" ${opt.value === value ? 'selected' : ''}>${opt.label}</option>`).join('')}
          </select>
        </div>
      `;
    }

    function createShotCard(shot, sceneId) {
      const composition = COMPOSITIONS.find(c => c.value === shot.composition);
      const size = SIZES.find(s => s.value === shot.size);
      const lens = LENSES.find(l => l.value === shot.lens);
      const moving = MOVINGS.find(m => m.value === shot.moving);
      const technique = TECHNIQUES.find(t => t.value === shot.technique);

      return `
        <div class="card border-l-4 border-blue-500 p-5">
          <div class="flex justify-between items-start mb-3">
            <div class="flex-1">
              <h4 class="font-bold text-base text-gray-800">ì»· #${shot.shotNumber}</h4>
              ${shot.description ? `<p class="text-xs text-gray-600 mt-0.5">${shot.description}</p>` : ''}
            </div>
            <div class="flex gap-1 ml-3">
              <button class="px-2 py-0.5 text-xs bg-blue-500 text-white rounded hover:bg-blue-600 transition whitespace-nowrap" onclick="editShot('${sceneId}', '${shot.id}')">í¸ì§‘</button>
              <button class="px-2 py-0.5 text-xs bg-red-500 text-white rounded hover:bg-red-600 transition whitespace-nowrap" onclick="deleteShot('${sceneId}', '${shot.id}')">ì‚­ì œ</button>
            </div>
          </div>

          <!-- ì •ë³´ í•œ ì¤„ì”© í‘œì‹œ -->
          <div class="space-y-2">
            <!-- ê¸°ë³¸ ì¹´ë©”ë¼ ì •ë³´ -->
            <div class="grid grid-cols-5 gap-2">
              <div class="info-item">
                <div class="info-label">êµ¬ë„</div>
                <div class="composition-badge composition-${shot.composition}">${composition ? composition.label : ''}</div>
              </div>
              <div class="info-item">
                <div class="info-label">ì‚¬ì´ì¦ˆ</div>
                <div class="info-value">${size ? size.label.split(' -')[0] : ''}</div>
              </div>
              <div class="info-item">
                <div class="info-label">ë Œì¦ˆ</div>
                <div class="info-value">${lens ? lens.label : ''}</div>
              </div>
              <div class="info-item">
                <div class="info-label">ë¬´ë¹™</div>
                <div class="info-value">${moving ? moving.label.split(' ')[0] : ''}</div>
              </div>
              <div class="info-item">
                <div class="info-label">ê¸°ë²•</div>
                <div class="info-value">${technique ? technique.label : ''}</div>
              </div>
            </div>

            <!-- ê¸¸ì´ & ì¸ë¬¼ & ì¥ì†Œ & ì†Œí’ˆ & ë°°ê²½ -->
            <div class="grid grid-cols-5 gap-2">
              <div class="info-item">
                <div class="info-label">ê¸¸ì´</div>
                <div class="info-value">${shot.duration}ì´ˆ</div>
              </div>
              <div class="info-item">
                <div class="info-label">ì¸ë¬¼</div>
                <div class="info-value">${shot.character || 'â€”'}</div>
              </div>
              <div class="info-item">
                <div class="info-label">ì¥ì†Œ</div>
                <div class="info-value">${shot.location || 'â€”'}</div>
              </div>
              <div class="info-item">
                <div class="info-label">ì†Œí’ˆ</div>
                <div class="info-value text-xs">${shot.props || 'â€”'}</div>
              </div>
              <div class="info-item">
                <div class="info-label">ë°°ê²½</div>
                <div class="info-value text-xs">${shot.setDesign || 'â€”'}</div>
              </div>
            </div>
          </div>
        </div>
      `;
    }

    function createScenePanel(scene) {
      const timeOfDay = TIME_OF_DAYS.find(t => t.value === scene.timeOfDay);
      return `
        <div class="bg-gradient-to-b from-gray-50 to-white rounded-lg shadow-lg overflow-hidden">
          <div class="gradient-to-r text-white p-6">
            <div class="flex justify-between items-start">
              <div class="flex-1">
                <div class="flex items-center gap-3">
                  <h3 class="text-2xl font-bold">ì”¬ #${scene.sceneNumber}</h3>
                  <div class="bg-white bg-opacity-20 px-3 py-1 rounded text-sm font-semibold">${timeOfDay ? timeOfDay.label : scene.timeOfDay}</div>
                </div>
                <p class="text-blue-100 mt-1">${scene.name}</p>
                ${scene.description ? `<p class="text-blue-50 text-sm mt-2">${scene.description}</p>` : ''}
              </div>
              <div class="flex gap-2">
                <button class="px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition font-medium" onclick="editSceneTimecode('${scene.id}')">ì‹œê°„ëŒ€ ìˆ˜ì •</button>
                <button class="px-4 py-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition font-medium" onclick="deleteScene('${scene.id}')">ì”¬ ì‚­ì œ</button>
              </div>
            </div>
          </div>
          <div class="p-6">
            ${scene.shots.length === 0 ? '<p class="text-center text-gray-500 py-8">ì»·ì´ ì—†ìŠµë‹ˆë‹¤. ì•„ë˜ì—ì„œ ì»·ì„ ì¶”ê°€í•˜ì„¸ìš”.</p>' : `
              <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                ${scene.shots.map(shot => createShotCard(shot, scene.id)).join('')}
              </div>
            `}
            <button class="w-full py-3 border-2 border-dashed border-blue-300 rounded-lg text-blue-600 hover:bg-blue-50 transition font-medium" onclick="showAddShotForm('${scene.id}')">+ ìƒˆë¡œìš´ ì»· ì¶”ê°€</button>
          </div>
        </div>
      `;
    }

    function renderStoryboardList() {
      const storyboards = manager.getAllStoryboards();
      const app = document.getElementById('app');

      app.innerHTML = `
        <header>
          <div class="header-content">
            <h1 class="text-3xl font-bold text-gray-900">ğŸ¬ ìŠ¤í† ë¦¬ë³´ë“œ ë©”ì´ì»¤</h1>
            <button class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium btn" onclick="showNewStoryboardDialog()">ìƒˆ ìŠ¤í† ë¦¬ë³´ë“œ</button>
          </div>
        </header>

        <main>
          <div class="text-center py-16">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">ìŠ¤í† ë¦¬ë³´ë“œë¥¼ ì‹œì‘í•˜ì„¸ìš”</h2>
            <p class="text-gray-600 mb-8">ìƒˆ ìŠ¤í† ë¦¬ë³´ë“œë¥¼ ë§Œë“¤ê±°ë‚˜ ê¸°ì¡´ ìŠ¤í† ë¦¬ë³´ë“œë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>

            ${storyboards.length > 0 ? `
              <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8">
                ${storyboards.map(sb => `
                  <div class="card p-6">
                    <h3 class="text-lg font-semibold text-gray-900">${sb.title}</h3>
                    ${sb.description ? `<p class="text-gray-600 text-sm mt-2">${sb.description}</p>` : ''}
                    <p class="text-gray-500 text-sm mt-4">ì”¬ ${sb.scenes.length}ê°œ</p>
                    <div class="flex gap-2 mt-4">
                      <button class="flex-1 px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition" onclick="openStoryboard('${sb.id}')">ì—´ê¸°</button>
                      <button class="px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition" onclick="confirmDeleteStoryboard('${sb.id}', '${sb.title}')">ì‚­ì œ</button>
                    </div>
                  </div>
                `).join('')}
              </div>
            ` : ''}

            <button class="px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium text-lg" onclick="showNewStoryboardDialog()">ìƒˆ ìŠ¤í† ë¦¬ë³´ë“œ ë§Œë“¤ê¸°</button>
          </div>
        </main>
      `;
    }

    function renderStoryboardEditor() {
      if (!currentStoryboard) return renderStoryboardList();

      const app = document.getElementById('app');

      app.innerHTML = `
        <header>
          <div class="header-content">
            <h1 class="text-3xl font-bold text-gray-900">ğŸ¬ ìŠ¤í† ë¦¬ë³´ë“œ ë©”ì´ì»¤</h1>
            <div class="flex gap-3">
              <button class="px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition" onclick="exportCurrentStoryboard()">ë‚´ë³´ë‚´ê¸°</button>
              <button class="px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition" onclick="goBack()">ëŒì•„ê°€ê¸°</button>
            </div>
          </div>
        </header>

        <main>
          <!-- ë§ˆìŠ¤í„° ì‚¬ì–‘ ì„¤ì • -->
          <div class="bg-gradient-to-r from-purple-50 to-pink-50 rounded-lg shadow-md p-6 mb-8 border border-purple-200">
            <div class="flex justify-between items-center mb-4">
              <div>
                <h2 class="text-2xl font-bold text-gray-900">âš™ï¸ ë§ˆìŠ¤í„° ì‚¬ì–‘</h2>
                <p class="text-sm text-gray-600 mt-1">í”„ë¡œì íŠ¸ ì „ì²´ì˜ ê¸°ìˆ  ì‚¬ì–‘ì„ ì„¤ì •í•©ë‹ˆë‹¤</p>
              </div>
              <button class="px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition font-medium" onclick="showMasterSpecDialog()">ìˆ˜ì •</button>
            </div>
            <div class="grid grid-cols-3 gap-4">
              <div class="bg-white p-3 rounded-lg">
                <div class="text-xs font-semibold text-gray-500 uppercase mb-1">í•´ìƒë„</div>
                <div class="text-lg font-bold text-gray-900">${currentStoryboard.masterResolution}</div>
              </div>
              <div class="bg-white p-3 rounded-lg">
                <div class="text-xs font-semibold text-gray-500 uppercase mb-1">í”„ë ˆì„ë ˆì´íŠ¸</div>
                <div class="text-lg font-bold text-gray-900">${currentStoryboard.masterFps}</div>
              </div>
              <div class="bg-white p-3 rounded-lg">
                <div class="text-xs font-semibold text-gray-500 uppercase mb-1">ìƒ‰ê³µê°„</div>
                <div class="text-lg font-bold text-gray-900">${currentStoryboard.masterColorSpace}</div>
              </div>
            </div>
          </div>

          <!-- í”„ë¡œì íŠ¸ ì •ë³´ -->
          <div class="bg-white rounded-lg shadow-md p-6 mb-8">
            <div class="flex justify-between items-start">
              <div>
                <h2 class="text-3xl font-bold text-gray-900">${currentStoryboard.title}</h2>
                ${currentStoryboard.description ? `<p class="text-gray-600 mt-2">${currentStoryboard.description}</p>` : ''}
              </div>
            </div>
          </div>

          ${currentStoryboard.scenes.length === 0 ? `
            <div class="text-center py-12 bg-white rounded-lg shadow-md">
              <p class="text-gray-500 mb-4">ì•„ì§ ì”¬ì´ ì—†ìŠµë‹ˆë‹¤.</p>
              <button class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition" onclick="showNewSceneDialog()">ì²« ë²ˆì§¸ ì”¬ ì¶”ê°€</button>
            </div>
          ` : `
            <div class="space-y-6 mb-8">
              ${currentStoryboard.scenes.map(scene => createScenePanel(scene)).join('')}
            </div>
          `}

          <button class="w-full py-4 border-2 border-dashed border-green-300 rounded-lg text-green-600 hover:bg-green-50 transition font-medium text-lg mb-8" onclick="showNewSceneDialog()">+ ìƒˆë¡œìš´ ì”¬ ì¶”ê°€</button>
        </main>
      `;
    }

    // ============================================
    // ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
    // ============================================

    function showNewStoryboardDialog() {
      const title = prompt('ìŠ¤í† ë¦¬ë³´ë“œ ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš”:');
      if (title && title.trim()) {
        manager.createStoryboard(title.trim());
        renderStoryboardList();
      }
    }

    function openStoryboard(id) {
      currentStoryboard = manager.getStoryboard(id);
      renderStoryboardEditor();
    }

    function confirmDeleteStoryboard(id, title) {
      if (confirm(`"${title}"ì„(ë¥¼) ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) {
        manager.deleteStoryboard(id);
        renderStoryboardList();
      }
    }

    function deleteStoryboard(id) {
      manager.deleteStoryboard(id);
      currentStoryboard = null;
      renderStoryboardList();
    }

    function goBack() {
      currentStoryboard = null;
      renderStoryboardList();
    }

    function showNewSceneDialog() {
      if (!currentStoryboard) return;
      const name = prompt('ì”¬ ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: ì˜¤í”„ë‹, ì œí’ˆ ì†Œê°œ):');
      if (name && name.trim()) {
        manager.addScene(currentStoryboard.id, name.trim());
        currentStoryboard = manager.getStoryboard(currentStoryboard.id);
        renderStoryboardEditor();
      }
    }

    function deleteScene(sceneId) {
      if (!currentStoryboard) return;
      if (confirm('ì´ ì”¬ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        manager.deleteScene(currentStoryboard.id, sceneId);
        currentStoryboard = manager.getStoryboard(currentStoryboard.id);
        renderStoryboardEditor();
      }
    }

    function showAddShotForm(sceneId) {
      if (!currentStoryboard) return;
      const html = `
        <div class="modal-overlay" onclick="if(event.target === this) closeModal()">
          <div class="modal">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">ìƒˆë¡œìš´ ì»· ì¶”ê°€</h2>
            <form onsubmit="handleAddShot(event, '${sceneId}')">
              <!-- ì¹´ë©”ë¼ ì •ë³´ -->
              <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">ğŸ“· ì¹´ë©”ë¼ ì •ë³´</h3>
              <div class="form-group mb-4">
                ${createSelect('composition-select', 'êµ¬ë„', COMPOSITIONS, 'eye_level')}
                ${createSelect('size-select', 'ì‚¬ì´ì¦ˆ', SIZES, 'full_shot')}
                ${createSelect('lens-select', 'ë Œì¦ˆ', LENSES, '50mm')}
                ${createSelect('moving-select', 'ë¬´ë¹™', MOVINGS, 'static')}
              </div>

              <!-- ì´¬ì˜ ê¸°ë²• & ê¸¸ì´ -->
              <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">â±ï¸ ì´¬ì˜ ì •ë³´</h3>
              <div class="form-group mb-4">
                ${createSelect('technique-select', 'ì´¬ì˜ ê¸°ë²•', TECHNIQUES, 'normal')}
                <div>
                  <label for="duration-input" class="text-sm font-medium text-gray-700 mb-2">ì¥ë©´ ê¸¸ì´ (ì´ˆ)</label>
                  <input type="number" id="duration-input" min="1" max="300" value="3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                </div>
              </div>

              <!-- ë°°ê²½/ì„¸íŠ¸ ì •ë³´ -->
              <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">ğŸ¬ ë°°ê²½ ì •ë³´</h3>
              <div class="form-group mb-4">
                <div>
                  <label for="character-input" class="text-sm font-medium text-gray-700 mb-2">ë“±ì¥ì¸ë¬¼</label>
                  <input type="text" id="character-input" placeholder="ì˜ˆ: ì£¼ì¸ê³µ, ì¡°ì—°" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                  <label for="location-input" class="text-sm font-medium text-gray-700 mb-2">ì¥ì†Œ</label>
                  <input type="text" id="location-input" placeholder="ì˜ˆ: ì‚¬ë¬´ì‹¤, ì•¼ì™¸" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                  <label for="props-input" class="text-sm font-medium text-gray-700 mb-2">ì†Œí’ˆ</label>
                  <input type="text" id="props-input" placeholder="ì˜ˆ: ì±…ìƒ, ì˜ì, ì¹´ë©”ë¼" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                  <label for="set-design-input" class="text-sm font-medium text-gray-700 mb-2">ë°°ê²½ì„¤ì •</label>
                  <input type="text" id="set-design-input" placeholder="ì˜ˆ: ë”°ëœ»í•œ í†¤, ë¯¸ë‹ˆë©€" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
              </div>

              <!-- ì„¤ëª… -->
              <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">ğŸ“ ì„¤ëª…</h3>
              <div class="mb-4">
                <label for="description-textarea" class="text-sm font-medium text-gray-700 mb-2">ì„¤ëª… (ì„ íƒ)</label>
                <textarea id="description-textarea" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="ì´ ì»·ì— ëŒ€í•œ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”..."></textarea>
              </div>

              <!-- ë²„íŠ¼ -->
              <div class="flex gap-2 mt-6">
                <button type="submit" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium">ì»· ì¶”ê°€</button>
                <button type="button" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition font-medium" onclick="closeModal()">ì·¨ì†Œ</button>
              </div>
            </form>
          </div>
        </div>
      `;
      document.getElementById('app').insertAdjacentHTML('beforeend', html);
    }

    function handleAddShot(event, sceneId) {
      event.preventDefault();
      if (!currentStoryboard) return;

      const composition = document.getElementById('composition-select').value;
      const size = document.getElementById('size-select').value;
      const lens = document.getElementById('lens-select').value;
      const moving = document.getElementById('moving-select').value;
      const technique = document.getElementById('technique-select').value;
      const duration = document.getElementById('duration-input').value;
      const character = document.getElementById('character-input').value;
      const location = document.getElementById('location-input').value;
      const props = document.getElementById('props-input').value;
      const setDesign = document.getElementById('set-design-input').value;
      const description = document.getElementById('description-textarea').value;

      manager.addShot(currentStoryboard.id, sceneId, {
        composition,
        size,
        lens,
        moving,
        description,
        technique,
        duration,
        character,
        location,
        props,
        setDesign,
      });

      currentStoryboard = manager.getStoryboard(currentStoryboard.id);
      closeModal();
      renderStoryboardEditor();
    }

    function editShot(sceneId, shotId) {
      if (!currentStoryboard) return;
      const scene = currentStoryboard.scenes.find(s => s.id === sceneId);
      if (!scene) return;
      const shot = scene.shots.find(s => s.id === shotId);
      if (!shot) return;

      const html = `
        <div class="modal-overlay" onclick="if(event.target === this) closeModal()">
          <div class="modal">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">ì»· í¸ì§‘</h2>
            <form onsubmit="handleUpdateShot(event, '${sceneId}', '${shotId}')">
              <!-- ì¹´ë©”ë¼ ì •ë³´ -->
              <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">ğŸ“· ì¹´ë©”ë¼ ì •ë³´</h3>
              <div class="form-group mb-4">
                ${createSelect('composition-edit', 'êµ¬ë„', COMPOSITIONS, shot.composition)}
                ${createSelect('size-edit', 'ì‚¬ì´ì¦ˆ', SIZES, shot.size)}
                ${createSelect('lens-edit', 'ë Œì¦ˆ', LENSES, shot.lens)}
                ${createSelect('moving-edit', 'ë¬´ë¹™', MOVINGS, shot.moving)}
              </div>

              <!-- ì´¬ì˜ ê¸°ë²• & ê¸¸ì´ -->
              <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">â±ï¸ ì´¬ì˜ ì •ë³´</h3>
              <div class="form-group mb-4">
                ${createSelect('technique-edit', 'ì´¬ì˜ ê¸°ë²•', TECHNIQUES, shot.technique)}
                <div>
                  <label for="duration-edit" class="text-sm font-medium text-gray-700 mb-2">ì¥ë©´ ê¸¸ì´ (ì´ˆ)</label>
                  <input type="number" id="duration-edit" min="1" max="300" value="${shot.duration}" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
              </div>

              <!-- ë°°ê²½/ì„¸íŠ¸ ì •ë³´ -->
              <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">ğŸ¬ ë°°ê²½ ì •ë³´</h3>
              <div class="form-group mb-4">
                <div>
                  <label for="character-edit" class="text-sm font-medium text-gray-700 mb-2">ë“±ì¥ì¸ë¬¼</label>
                  <input type="text" id="character-edit" value="${shot.character}" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                  <label for="location-edit" class="text-sm font-medium text-gray-700 mb-2">ì¥ì†Œ</label>
                  <input type="text" id="location-edit" value="${shot.location}" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                  <label for="props-edit" class="text-sm font-medium text-gray-700 mb-2">ì†Œí’ˆ</label>
                  <input type="text" id="props-edit" value="${shot.props}" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
                <div>
                  <label for="set-design-edit" class="text-sm font-medium text-gray-700 mb-2">ë°°ê²½ì„¤ì •</label>
                  <input type="text" id="set-design-edit" value="${shot.setDesign}" class="w-full px-3 py-2 border border-gray-300 rounded-lg">
                </div>
              </div>

              <!-- ì„¤ëª… -->
              <h3 class="text-lg font-semibold text-gray-800 mt-6 mb-3">ğŸ“ ì„¤ëª…</h3>
              <div class="mb-4">
                <label for="description-edit" class="text-sm font-medium text-gray-700 mb-2">ì„¤ëª…</label>
                <textarea id="description-edit" class="w-full px-3 py-2 border border-gray-300 rounded-lg">${shot.description}</textarea>
              </div>

              <!-- ë²„íŠ¼ -->
              <div class="flex gap-2 mt-6">
                <button type="submit" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium">ì €ì¥</button>
                <button type="button" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition font-medium" onclick="closeModal()">ì·¨ì†Œ</button>
              </div>
            </form>
          </div>
        </div>
      `;
      document.getElementById('app').insertAdjacentHTML('beforeend', html);
    }

    function handleUpdateShot(event, sceneId, shotId) {
      event.preventDefault();
      if (!currentStoryboard) return;

      const composition = document.getElementById('composition-edit').value;
      const size = document.getElementById('size-edit').value;
      const lens = document.getElementById('lens-edit').value;
      const moving = document.getElementById('moving-edit').value;
      const technique = document.getElementById('technique-edit').value;
      const duration = document.getElementById('duration-edit').value;
      const character = document.getElementById('character-edit').value;
      const location = document.getElementById('location-edit').value;
      const props = document.getElementById('props-edit').value;
      const setDesign = document.getElementById('set-design-edit').value;
      const description = document.getElementById('description-edit').value;

      manager.updateShot(currentStoryboard.id, sceneId, shotId, {
        composition,
        size,
        lens,
        moving,
        description,
        technique,
        duration,
        character,
        location,
        props,
        setDesign,
      });

      currentStoryboard = manager.getStoryboard(currentStoryboard.id);
      closeModal();
      renderStoryboardEditor();
    }

    function deleteShot(sceneId, shotId) {
      if (!currentStoryboard) return;
      if (confirm('ì´ ì»·ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        manager.deleteShot(currentStoryboard.id, sceneId, shotId);
        currentStoryboard = manager.getStoryboard(currentStoryboard.id);
        renderStoryboardEditor();
      }
    }

    function exportCurrentStoryboard() {
      if (!currentStoryboard) return;
      const json = manager.exportStoryboard(currentStoryboard);
      const blob = new Blob([json], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `${currentStoryboard.title}-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      URL.revokeObjectURL(url);
    }

    function showMasterSpecDialog() {
      if (!currentStoryboard) return;
      const html = `
        <div class="modal-overlay" onclick="if(event.target === this) closeModal()">
          <div class="modal">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">âš™ï¸ ë§ˆìŠ¤í„° ì‚¬ì–‘ ì„¤ì •</h2>
            <p class="text-sm text-gray-600 mb-6">í”„ë¡œì íŠ¸ ì „ì²´ì— ì ìš©ë  ê¸°ìˆ  ì‚¬ì–‘ì„ ì„¤ì •í•©ë‹ˆë‹¤</p>
            <form onsubmit="handleMasterSpecUpdate(event)">
              <div class="form-group mb-4">
                ${createSelect('master-resolution-select', 'í•´ìƒë„', RESOLUTIONS, currentStoryboard.masterResolution)}
                ${createSelect('master-fps-select', 'FPS', FPS_OPTIONS, currentStoryboard.masterFps)}
                ${createSelect('master-color-space-select', 'ìƒ‰ê³µê°„', COLOR_SPACES, currentStoryboard.masterColorSpace)}
              </div>

              <div class="flex gap-2 mt-6">
                <button type="submit" class="flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition font-medium">ì €ì¥</button>
                <button type="button" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition font-medium" onclick="closeModal()">ì·¨ì†Œ</button>
              </div>
            </form>
          </div>
        </div>
      `;
      document.getElementById('app').insertAdjacentHTML('beforeend', html);
    }

    function handleMasterSpecUpdate(event) {
      event.preventDefault();
      if (!currentStoryboard) return;

      const masterResolution = document.getElementById('master-resolution-select').value;
      const masterFps = document.getElementById('master-fps-select').value;
      const masterColorSpace = document.getElementById('master-color-space-select').value;

      currentStoryboard.masterResolution = masterResolution;
      currentStoryboard.masterFps = masterFps;
      currentStoryboard.masterColorSpace = masterColorSpace;
      currentStoryboard.updatedAt = new Date();

      manager.persistToStorage();
      closeModal();
      renderStoryboardEditor();
    }

    function editSceneTimecode(sceneId) {
      if (!currentStoryboard) return;
      const scene = currentStoryboard.scenes.find(s => s.id === sceneId);
      if (!scene) return;

      const html = `
        <div class="modal-overlay" onclick="if(event.target === this) closeModal()">
          <div class="modal">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">ğŸŒ… ì”¬ ì‹œê°„ëŒ€ ì„¤ì •</h2>
            <p class="text-sm text-gray-600 mb-6">ì´ ì”¬ì´ ì¼ì–´ë‚˜ëŠ” ì‹œê°„ëŒ€ë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
            <form onsubmit="handleSceneTimecodeUpdate(event, '${sceneId}')">
              <div class="space-y-4 mb-6">
                <div>
                  <label class="block text-sm font-medium text-gray-700 mb-3">ì‹œê°„ëŒ€</label>
                  <div class="grid grid-cols-2 gap-3">
                    ${TIME_OF_DAYS.map(t => `
                      <label class="flex items-center p-3 border-2 border-gray-200 rounded-lg cursor-pointer hover:border-blue-500 transition ${scene.timeOfDay === t.value ? 'border-blue-500 bg-blue-50' : ''}">
                        <input type="radio" name="time-of-day" value="${t.value}" ${scene.timeOfDay === t.value ? 'checked' : ''} class="mr-2" required>
                        <span class="text-sm font-medium">${t.label}</span>
                      </label>
                    `).join('')}
                  </div>
                </div>
              </div>

              <div class="flex gap-2">
                <button type="submit" class="flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition font-medium">ì €ì¥</button>
                <button type="button" class="flex-1 px-4 py-2 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition font-medium" onclick="closeModal()">ì·¨ì†Œ</button>
              </div>
            </form>
          </div>
        </div>
      `;
      document.getElementById('app').insertAdjacentHTML('beforeend', html);
    }

    function handleSceneTimecodeUpdate(event, sceneId) {
      event.preventDefault();
      if (!currentStoryboard) return;

      const timeOfDay = document.querySelector('input[name="time-of-day"]:checked').value;

      const scene = currentStoryboard.scenes.find(s => s.id === sceneId);
      if (scene) {
        scene.timeOfDay = timeOfDay;
        scene.updatedAt = new Date();
      }

      manager.persistToStorage();
      closeModal();
      renderStoryboardEditor();
    }

    function closeModal() {
      const overlay = document.querySelector('.modal-overlay');
      if (overlay) overlay.remove();
    }

    // ============================================
    // ì´ˆê¸°í™”
    // ============================================

    renderStoryboardList();
  </script>
</body>
</html>
